**# Симулятор броуновского движения

В этом проекте реализуется двухмерный симулятор хаотичного теплового движения.

В качестве модели используется так называемое броуновское движение.
Полагаем радиус всех частиц равными, начальную скорость случайную.
Полагаем все соударения абсолютно упругими и считаем потенциальную энергию взаимодействия частиц равной нулю.

## Запуск проекта

Чтобы запустить проект установите зависимости: `python -m pip install -r requirements.txt`, 
а затем запустите главный файл: `python main.py`  

## Обоснование и рассчеты

Для начала введем ограничения модели. 
- Положим все соударения частиц между собой и с границами абсолютно упругими, т.е. потерь энергии при взаимодействии не происходит.
- Положим энергию взаимодействия всех частиц равной нулю.
- Положим сопротивление среды равное нулю, т.е. частицы двигаются в абсолютном вакууме.
- Положим, что границы бесконечно твердо стоят на месте. 


Исходя из этого, нам остается лишь рассмотреть взаимодействия 2ух видов:
1. Удар частицы об границу,
2. Удар частицы об частицу.

Для этих взаимодействий необходимо выразить скорости движения после взаимодействия через скорости до взаимодействия.

### 1. Удар частицы об границу.

Введем систему координат, связанную с границей с центром в точке соприкосновения частицы с границей.

Тогда $\mathbf{n}$ — единичный вектор, направленный нормально к границе, $$\mathbf{t}$$ — единичный вектор, направленный границы.

Скорость шара можно представить как:
$$
\mathbf{v_1} = \mathbf{v_{\text{t}}} + \mathbf{v_{\text{n}}}
$$

где:
- $\mathbf{v_{\text{t}}} = \mathbf{v_1} \cdot \mathbf{t}$ — тангенциальная компонента $\mathbf{v_1}$,
- $\mathbf{v_{\text{n}}} = \mathbf{v_1} \cdot \mathbf{n}$ — нормальная компонента $\mathbf{v_1}$.

При абсолютно упругом столкновении:
  - Тангенциальная компонента скорости $$\mathbf{v_{\text{t}}}$$ остается неизменной.
  - Нормальная компонента скорости инвертируется (меняет направление).

  Таким образом, новая скорость шара $$\mathbf{v_1'}$$ будет равна:
  $$
  \mathbf{v_1'} = \mathbf{v_{\text{t}}} - \mathbf{v_{\text{n}}}
  $$

Таким образом, новая скорость шара после удара со стеной будет выражаться как:

$$
\mathbf{v_1'} = \mathbf{v_1} - 2(\mathbf{v_1} \cdot \mathbf{n}) \mathbf{n}
$$

### Удар частицы об частицу.

1. **Сохранение импульса**:
 Вектор импульса системы до столкновения равен вектору импульса после столкновения:
 $$
 m \mathbf{v_1} + m \mathbf{v_2} = m \mathbf{v_1'} + m \mathbf{v_2'}
 $$
 Упрощая это уравнение, мы можем исключить массу:
 $$
 \mathbf{v_1} + \mathbf{v_2} = \mathbf{v_1'} + \mathbf{v_2'}
 $$

2. **Сохранение энергии** (для упругого столкновения):
 Суммарная кинетическая энергия до столкновения равна суммарной кинетической энергии после столкновения:
 $$
 \frac{1}{2} m v_1^2 + \frac{1}{2} m v_2^2 = \frac{1}{2} m v_1'^2 + \frac{1}{2} m v_2'^2
 $$
 Упрощая, получаем:
 $$
 v_1^2 + v_2^2 = v_1'^2 + v_2'^2
 $$

3. **Угловая зависимость**:
 Учитываем угол между направлениями скоростей, поскольку они могут быть направлены в разные стороны. Это можно учесть через угол столкновения.

4. **Решение уравнений**:
 Мы можем выразить новые скорости через старые. Для упругого столкновения с одинаковыми шарами, можно использовать формулу:
 $$ \mathbf{v_1'} = \mathbf{v_1} - \frac{2m}{m + m} \frac{(\mathbf{v_1} - \mathbf{v_2}) \cdot \mathbf{n}}{|\mathbf{n}|^2} \mathbf{n} $$

 $$ \mathbf{v_2'} = \mathbf{v_2} - \frac{2m}{m + m} \frac{(\mathbf{v_2} - \mathbf{v_1}) \cdot (-\mathbf{n})}{|-\mathbf{n}|^2} (-\mathbf{n}) $$
 Здесь $\mathbf{n}$ — единичный вектор, направленный от одного шара к другому на момент столкновения.

 Упрощая, получаем:
 $$ \mathbf{v_1'} = \mathbf{v_1} - \frac{(\mathbf{v_1} - \mathbf{v_2}) \cdot \mathbf{n}}{|\mathbf{n}|^2} \mathbf{n} $$
 $$ \mathbf{v_2'} = \mathbf{v_2} - \frac{(\mathbf{v_2} - \mathbf{v_1}) \cdot (-\mathbf{n})}{|-\mathbf{n}|^2} (-\mathbf{n})$$

## Технологии
В проекте используется numpy для удобства работы с векторами.
Так же используется tkinter для визуализации симуляции.
Поскольку цель проекта - освоение numpy, мощности **GPU исользованы не будут**.**